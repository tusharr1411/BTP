{"ast":null,"code":"import{useState}from\"react\";import\"./FileUpload.css\";import axios from\"axios\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";const FileUpload=_ref=>{let{contract,account,provider}=_ref;const[file,setFile]=useState(null);const[fileName,setFileName]=useState(\"No File Selected\");const handleSubmit=async e=>{e.preventDefault();if(file){try{const formData=new FormData();formData.append(\"file\",file);//pinata code\nconst resFile=await axios({method:\"post\",url:\"https://api.pinata.cloud/pinning/pinFileToIPFS\",data:formData,headers:{pinata_api_key:\"37863d70ec4408f0253f\",pinata_secret_api_key:\"6abf8c985a9e66a25d2a2d501c186ec273fc56f3903b8ae9eb2bdb6ee0e9b00d\",\"Content-Type\":\"multipart/form-data\"}});//////\n//collecting image hash\nconst fileHash=\"https://gateway.pinata.cloud/ipfs/\".concat(resFile.data.IpfsHash);contract.add(account,fileHash);alert(\"successfully Uploaded\");setFileName(\"No file Selected\");setFile(null);}catch(e){console.log(\"Unable to upload\");alert(\"Unable to upload\");}}};const retrieveFile=e=>{const data=e.target.files[0];// files array of selected files\nconst reader=new window.FileReader();reader.readAsArrayBuffer(data);reader.onloadend=()=>{setFile(e.target.files[0]);};setFileName(e.target.files[0].name);e.preventDefault();};return/*#__PURE__*/_jsx(\"div\",{className:\"top\",children:/*#__PURE__*/_jsxs(\"form\",{className:\"form\",onSubmit:handleSubmit,children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"file-upload\",className:\"choose\",children:\" Choose Your File\"}),/*#__PURE__*/_jsx(\"input\",{type:\"file\",id:\"file-upload\",name:\"data\",onChange:retrieveFile}),/*#__PURE__*/_jsxs(\"span\",{className:\"textArea\",children:[\"File: \",fileName]}),/*#__PURE__*/_jsx(\"button\",{className:\"upload\",type:\"submit\",disabled:!file,children:\"Upload File\"})]})});};export default FileUpload;//////////////////////////////////////////////","map":{"version":3,"names":["useState","axios","jsx","_jsx","jsxs","_jsxs","FileUpload","_ref","contract","account","provider","file","setFile","fileName","setFileName","handleSubmit","e","preventDefault","formData","FormData","append","resFile","method","url","data","headers","pinata_api_key","pinata_secret_api_key","fileHash","concat","IpfsHash","add","alert","console","log","retrieveFile","target","files","reader","window","FileReader","readAsArrayBuffer","onloadend","name","className","children","onSubmit","htmlFor","type","id","onChange","disabled"],"sources":["/root/blockchain_projects/project_btp/frontend/src/components/FileUpload.js"],"sourcesContent":["import { useState } from \"react\";\nimport \"./FileUpload.css\";\nimport axios from \"axios\";\n\n\n\nconst FileUpload = ({contract, account, provider})=>{\n    const [file, setFile] = useState(null);\n    const [fileName, setFileName] = useState(\"No File Selected\");\n\n    const handleSubmit= async (e)=>{\n        e.preventDefault();\n        if(file){\n            try{\n                const formData = new FormData();\n                formData.append(\"file\", file);\n\n                //pinata code\n                const resFile = await axios({\n                    method:\"post\",\n                    url:\"https://api.pinata.cloud/pinning/pinFileToIPFS\",\n                    data:formData,\n                    headers:{\n                        pinata_api_key: `37863d70ec4408f0253f`,\n                        pinata_secret_api_key: `6abf8c985a9e66a25d2a2d501c186ec273fc56f3903b8ae9eb2bdb6ee0e9b00d`,\n                        \"Content-Type\":\"multipart/form-data\",\n                    },\n                });\n                //////\n\n\n                //collecting image hash\n                const fileHash = `https://gateway.pinata.cloud/ipfs/${resFile.data.IpfsHash}`;\n                contract.add(account,fileHash);\n                alert(\"successfully Uploaded\");\n                setFileName(\"No file Selected\");\n                setFile(null);\n            }\n            catch(e){\n                console.log(\"Unable to upload\")\n                alert(\"Unable to upload\");\n            }\n        }\n\n\n    }\n\n    const retrieveFile =  (e)=>{\n        const data = e.target.files[0];// files array of selected files\n        const reader = new window.FileReader();\n        reader.readAsArrayBuffer(data);\n        reader.onloadend=()=>{\n            setFile(e.target.files[0]);\n        }\n        setFileName(e.target.files[0].name);\n        e.preventDefault();\n    }\n\n\n    return (\n    <div className=\"top\">\n        <form className=\"form\" onSubmit={handleSubmit}>\n            <label htmlFor = \"file-upload\" className=\"choose\"> Choose Your File</label>\n            <input type=\"file\"  id =\"file-upload\" name=\"data\" onChange={retrieveFile}></input>\n            <span className=\"textArea\" >File: {fileName}</span>\n            <button className=\"upload\" type=\"submit\" disabled={!file}>Upload File</button>\n        </form>\n    </div>\n    )\n}\n\nexport default FileUpload;\n\n\n\n//////////////////////////////////////////////\n\n\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}